<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Simple CORS Proxy Demo</title>
  <style>
    body { font-family: system-ui, Arial; margin: 18px; max-width: 900px; }
    input { width: 72%; padding: 8px; margin-right:8px; }
    button { padding: 8px 12px; }
    pre { background:#f6f7f8; border:1px solid #ddd; padding:10px; white-space:pre-wrap; max-height:360px; overflow:auto; }
    iframe { width:100%; height:500px; border:1px solid #ccc; display:block; margin-top:10px; }
    label { display:inline-block; margin-left:8px; font-size:0.9rem; color:#444; }
  </style>
</head>
<body>
  <h2>Simple CORS Proxy Demo (client-only)</h2>
  <p>Enter a URL and press <strong>Fetch</strong>. This uses a public CORS proxy (for testing only).</p>

  <input id="url" placeholder="https://example.com" />
  <button id="fetchBtn">Fetch</button>
  <label><input type="checkbox" id="render"> Render in sandboxed iframe (scripts blocked)</label>

  <h4>Response (preview)</h4>
  <pre id="output">No request yet.</pre>

  <div id="frameWrap"></div>

  <script>
    // CHANGE THIS if you want a different public proxy:
    // Many public proxies exist; reliability/privacy varies. Use only for testing.
    const PROXY_PREFIX = 'https://corsproxy.io/?'; // example public proxy

    const btn = document.getElementById('fetchBtn');
    const out = document.getElementById('output');
    const urlInput = document.getElementById('url');
    const frameWrap = document.getElementById('frameWrap');
    const renderCheckbox = document.getElementById('render');

    // simple helper: strip <script> tags (basic, not bulletproof)
    function stripScripts(html) {
      return html.replace(/<script[\s\S]*?<\/script>/gi, '');
    }

    btn.addEventListener('click', async () => {
      frameWrap.innerHTML = ''; // clear iframe
      const raw = urlInput.value.trim();
      if (!raw) { alert('Enter a URL starting with http:// or https://'); return; }
      if (!/^https?:\/\//i.test(raw)) { alert('URL must start with http:// or https://'); return; }

      out.textContent = 'Fetching... (may fail if proxy or target blocks requests)';
      try {
        const target = encodeURIComponent(raw);
        const fetchUrl = PROXY_PREFIX + target;
        const res = await fetch(fetchUrl);
        const ct = res.headers.get('content-type') || '';
        // show first line of content-type
